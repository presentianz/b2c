{% extends 'Admin/admin_layout.html.twig' %}
{% block stylesheets %}
<link rel="stylesheet" href="{{asset('js/datatables/datatables.css')}}" type="text/css" />
{% endblock %}

{% block adminProduct %}
<li class="active">
  <a href="#" class="auto">
    <span class="pull-right text-muted">
      <i class="i i-circle-sm-o text"></i>
      <i class="i i-circle-sm text-active"></i>
    </span>
    <i class="i i-t-shirt icon">
    </i>
    <span class="font-bold">商品管理</span>
  </a>
  <ul class="nav dk">
   <li  class="active">
    <a href="{{ path('admin_product') }}" class="auto">
      <span class="pull-right text-muted">
        <i class="i i-circle-sm-o text"></i>
        <i class="i i-circle-sm text-active"></i>
      </span>
      <i class="i i-dot"></i>
      <span>商品列表</span>
    </a>
  </li>
  <li >
   <a href="{{ path('admin_product_new') }}" class="auto">  
     <i class="i i-dot"></i>
     <span>添加商品</span>
   </a>
 </li>
</ul>
</li>
{% endblock %}

{% block body -%}

<section id="content">
  <section class="vbox">
    <header class="header bg-light b-b">
        <p>商品列表</p>
    </header>
    <section class="scrollable padder">
      
      <section class="panel panel-default">
        <div class="table-responsive">
          <div class="dataTables_wrapper" role="grid">
            <div class="row">
              <div class="col-sm-6">
                <div class="dataTables_length">
                  <a class="dropdown open">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
                      每页显示 <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu animated fadeInRight">            
                      <li>
                        <span class="arrow top"></span>
                        <a href="{{ path('admin_product',{item_no : 20}) }}">20行</a>
                      </li>
                      <li>
                        <a href="{{ path('admin_product',{item_no : 40}) }}">40行</a>
                      </li>

                      <li>
                        <a href="{{ path('admin_product',{item_no : 60}) }}">60行</a>
                      </li>
                    </ul>
                  </a>
                </div>
              </div>
              <div class="col-sm-6"><div class="dataTables_filter" id="example_filter"><form action="{{ path('admin_product') }}" method="get"><label>搜索 <input type="text" aria-controls="example" name="keys" value="{{app.request.get('keys')}}"></form></label></div></div>
            </div>
            <table class="table table-striped m-b-none dataTable">
              <thead>
                <tr role="row">
                  {% if not app.request.get('sort') or app.request.get('sort') == 7 %}
                  <th class="sorting_asc"><a href="{{ path('admin_product',{sort:8, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">ID</a></th>
                  {% elseif app.request.get('sort') == 8 %}
                  <th class="sorting_desc"><a href="{{ path('admin_product',{sort:7, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">ID</a></th>
                  {% else %}
                  <th class="sorting"><a href="{{ path('admin_product',{sort:7, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">ID</a></th>
                  {% endif %}
                  {% if app.request.get('sort') == 9 %}
                  <th class="sorting_asc"><a href="{{ path('admin_product',{sort:10, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">名称</a></th>
                  {% elseif app.request.get('sort') == 10 %}
                  <th class="sorting_desc"><a href="{{ path('admin_product',{sort:9, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">名称</a></th>
                  {% else %}
                  <th class="sorting"><a href="{{ path('admin_product',{sort:9, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">名称</a></th>
                  {% endif %}
                  {% if app.request.get('sort') == 2 %}
                  <th class="sorting_asc"><a href="{{ path('admin_product',{sort:3, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">原价</a></th>
                  {% elseif app.request.get('sort') == 3 %}
                  <th class="sorting_desc"><a href="{{ path('admin_product',{sort:2, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">原价</a></th>
                  {% else %}
                  <th class="sorting"><a href="{{ path('admin_product',{sort:2, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">原价</a></th>
                  {% endif %}
                  {% if app.request.get('sort') == 11 %}
                  <th class="sorting_asc"><a href="{{ path('admin_product',{sort:12, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">折后价格</a></th>
                  {% elseif app.request.get('sort') == 12 %}
                  <th class="sorting_desc"><a href="{{ path('admin_product',{sort:11, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">折后价格</a></th>
                  {% else %}
                  <th class="sorting"><a href="{{ path('admin_product',{sort:11, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">折后价格</a></th>
                  {% endif %}
                  {% if app.request.get('sort') == 13 %}
                  <th class="sorting_asc"><a href="{{ path('admin_product',{sort:6, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">浏览次数</a></th>
                  {% elseif app.request.get('sort') == 6 %}
                  <th class="sorting_desc"><a href="{{ path('admin_product',{sort:13, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">浏览次数</a></th>
                  {% else %}
                  <th class="sorting"><a href="{{ path('admin_product',{sort:13, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">浏览次数</a></th>
                  {% endif %}
                  {% if app.request.get('sort') == 14 %}
                  <th class="sorting_asc"><a href="{{ path('admin_product',{sort:4, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">销售</a></th>
                  {% elseif app.request.get('sort') == 4 %}
                  <th class="sorting_desc"><a href="{{ path('admin_product',{sort:14, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">销售</a></th>
                  {% else %}
                  <th class="sorting"><a href="{{ path('admin_product',{sort:14, item_no:app.request.get('item_no'),page:app.request.get('page'),keys:app.request.get('keys')}) }}">销售</a></th>
                  {% endif %}
                  <th>编辑</th>
                </tr>
              </thead>
              <tbody role="alert" aria-live="polite" aria-relevant="all">
                {% for entity in data.products %}
                <tr>
                  <td><a href="{{ path('admin_product_show', { 'id': entity.id }) }}">{{ entity.id }}</a></td>

                  <td>
                    {% if entity.name|length > 20 %}
                    <span title="{{ entity.name }}">{{ entity.name|slice(0, 20) }}...</span>
                    {% else %}
                    <span title="{{ entity.name }}">{{ entity.name }}</span>
                    {% endif %}</td>

                    <td>{{ entity.price }}</td>

                    <td>{{ entity.priceDiscounted }}</td>

                    <td>{{ entity.click }}</td>

                    <td>{{ entity.soldNo }}</td>

                    <td>
                      <a href="{{ path('admin_product_edit', { 'id': entity.id }) }}">编辑</a>
                    </td>

                  </tr>
                  {% endfor %}
                </tbody>
              </table>
              <div class="row">
                <div class="col-sm-6">
                  <div class="dataTables_info" id="DataTables_Table_0_info">Showing 1 to {{ data.total_page }} of {{ data.total_no }} entries</div>
                </div>
                <div class="col-sm-6">
                  <div class="dataTables_paginate paging_full_numbers select-page-number" id="DataTables_Table_0_paginate">
                    <a tabindex="0" class="first paginate_button paginate_button_disabled" id="DataTables_Table_0_first" href="{{ path('admin_product',{sort:app.request.get('sort'), item_no:app.request.get('item_no'),page:1,keys:app.request.get('keys')}) }}">First</a>
                    <a tabindex="0" class="previous paginate_button paginate_button_disabled" id="DataTables_Table_0_previous" href="{{ path('admin_product',{sort:app.request.get('sort'), item_no:app.request.get('item_no'),page:(app.request.get('page')) ? app.request.get('page')-1 : 2,keys:app.request.get('keys')}) }}">Previous</a>
                    <span>
                      {% for i in 1..data.total_page %}
                      <a tabindex="0" href="{{ path('admin_product', {
                              keys : app.request.get('keys'),
                              page : i,
                              sort : app.request.get('sort'),
                              item_no: app.request.get('item_no')
                          }) }}" {% if not app.request.get('page') and i == 1 %} class="paginate_activepaginate_button" {% elseif i == app.request.get('page') %} class="paginate_active paginate_button" {% else %} class="paginate_button" {% endif %}> {{ i }}</a>
                      {% endfor %}
                    </span>
                    <a tabindex="0" class="next paginate_button" id="DataTables_Table_0_next" href="{{ path('admin_product',{sort:app.request.get('sort'), item_no:app.request.get('item_no'),page:(app.request.get('page')) ? app.request.get('page')+1 : 2,keys:app.request.get('keys')}) }}">Next</a>
                    <a tabindex="0" class="last paginate_button" id="DataTables_Table_0_last" href="{{ path('admin_product',{sort:app.request.get('sort'), item_no:app.request.get('item_no'),page:data.total_page,keys:app.request.get('keys')}) }}">Last</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </section>
    </section>
    <a href="#" class="hide nav-off-screen-block" data-toggle="class:nav-off-screen" data-target="#nav"></a>
  </section>

    {#<h1>Product list</h1>

    <table class="records_list">
        <thead>
            <tr>
                <th>Id</th>
                <th>Name</th>
                <th>Price</th>
                <th>Price_discounted</th>
                <th>Viewed_count</th>
                <th>Soldno</th>
                <th>Actions</th>
        </tr>

        </thead>
        <tbody>
        {% for entity in entities %}
            <tr>
                <td><a href="{{ path('admin_product_show', { 'id': entity.id }) }}">{{ entity.id }}</a></td>

                <td>{{ entity.name }}</td>

                <td>{{ entity.price }}</td>

                <td>{{ entity.pricediscounted }}</td>

                <td>{{ entity.viewedcount }}</td>

                <td>{{ entity.soldNo }}</td>

                <td>
                <ul>
                    <li>
                        <a href="{{ path('admin_product_show', { 'id': entity.id }) }}">show</a>
                    </li>
                    <li>
                        <a href="{{ path('admin_product_edit', { 'id': entity.id }) }}">edit</a>
                    </li>
                </ul>
                </td>

        </tr>

        {% endfor %}
        </tbody>
    </table>

        <ul>
        <li>
            <a href="{{ path('admin_product_new') }}">
                Create a new entry
            </a>
        </li>
      </ul>#}
      

      {% endblock %}
      {% block javascripts %}
      <script src="{{asset('js/datatables/jquery.dataTables.min.js')}}"></script>
      <script src="{{asset('js/datatables/jquery.csv-0.71.min.js')}}"></script>
      <script src="{{asset('js/pagination.js')}}"></script>
      {% endblock %}